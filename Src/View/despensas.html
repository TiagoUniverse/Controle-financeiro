<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../Assets//Css//styles.css" rel="stylesheet">
  <link href="../../Assets//Css//dropdown.css" rel="stylesheet">
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" 
  integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"> -->
  <!-- <title><?php echo "Despensas de " . $_SESSION['nomeMes'] . " de " . $_SESSION['ano']; ?></title> -->
</head>

<body>
  <?php require_once "Recursos/Navegacao.php"; ?>
  <form action="mes.php" method="post">
    <input type="hidden" name="statusMes" value="<?php echo $_SESSION['statusMes']; ?>">
    <button class="voltar-menu" style="border:none;">Voltar</button>
  </form>

  <main class="main-despensas">
    <h2><?php echo $_SESSION['quinzena'] . ": " . $_SESSION['nomeMes'] . " de " . $_SESSION['ano']  ; ?></h2>
    <h3><?php echo "Despensas: " . $_SESSION['tipo_registro']; ?></h3>
    <p>Clique em registrar e manipule os registros</p>
    <table class="table-dinheiroTotal">
      <thead>
        <tr>
          <th> Gasto total </th>
          <th>Receita total</th>
          <th>Resultado da subtração</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th><?php echo "R$" . $dinheiroSaida; ?> </th>
          <th><?php echo "R$" . $dinheiroEntrada; ?> </th>
          <th style="color:#e61e19;"><?php echo "R$" . ($dinheiroEntrada - $dinheiroSaida); ?> </th>
        </tr>
      </tbody>
    </table>
    <br>
    <session>
      <br>
      <?php
      if ($_SESSION['quinzena'] == "Quinzena 1") {
        echo "<img src='../../Assets/img/dia 15.png' alt='a calendar with the number 15' width='72' height='70'> ";
      } else {
        echo "<img src='../../Assets/img/dia 30.png' alt='a calendar with the number 30' width='72' height='70'> ";
      }
      ?>
      <h2 id="Saida_title">Saída</h2>
      <a href="#Entrada_title"> Navegar até os registros de Entrada</a>
      <table class="table-saida">
        <thead>
          <tr>
            <th>Nª</th>
            <th>Descrição</th>
            <th>valor</th>
            <th>Data</th>
            <th>Alteração</th>
            <th>Exclusão</th>
          </tr>
        </thead>
        <tbody>
          <?php
          $contador = 1;
          foreach ($Saida_fetch as $linha) {
          ?>
            <tr>
              <td> <?php echo $contador; ?> </td>
              <td> <?php echo $linha['descricao']; ?> </td>
              <td> <?php echo "R$" . $linha['valor']; ?> </td>
              <td> <?php echo $linha['dataDespensa']; ?> </td>
              <td>
                <form action="alterar.php" method="post">
                  <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                  <input type="hidden" value="DESPENSAS" name="pagina_inicial">
                  <button type="submit"><img src="../../Assets//Icons//pencil.png" class="icon_exclusao"></button>
                </form>
              </td>
              <td>
                <form action="excluir.php" method="post">
                  <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                  <input type="hidden" value="DESPENSAS" name="pagina_inicial">
                  <button type="submit"><img src="../../Assets//Icons//x-mark-xxl.png" class="icon_exclusao"></button>
                </form>
              </td>
            </tr>
          <?php
            $contador++;
          }

          /*┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
          * │                                Adicionado um novo registro                                                    │
          * └───────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
          */

          if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO SAIDA") {
          ?>
            <form method="post">
              <input type="hidden" name="adicionando_registro" value='SALVANDO REGISTRO SAIDA'>
              <input type="hidden" name="statusDespensa" value='3'>
              <tr>
                <th>Nª</th>
                <th><input type="text" name="descricao" placeholder="Nome do produto"></th>
                <th><input type="number" min="1" step="any" name="valor" placeholder="2.00"></th>
                <th> <input type="date" name="data" value='<?php echo date("Y-m-d"); ?>'></th>
              </tr>
            <?php
          }
            ?>
        </tbody>
      </table>

      <?php

      /*┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
      * │                                Botões de manipulação                                                          │
      * └───────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
      */

      if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO SAIDA") {
      ?>
        <div class="botoes-registro">

          <button type="submit" class="botao-registrar">Registrar</button>
          </form>
          <form action="despensas.php" method="post">
            <input type="hidden" value="" name="adicionando_registro">
            <button type="submit" class="botao-cancelar">Cancelar</button>
          </form>
        </div>

      <?php
      }

      if ($adicionando_registro == null) {
      ?>
        <form action="despensas.php" method="post">
          <input type="hidden" value="REGISTRANDO SAIDA" name="adicionando_registro">
          <button type="submit" class="botao-novoRegistro">Adicionar um novo registro</button>
        </form>
      <?php
      }
      ?>
    </session>

    <session>
      <br>
      <?php
      if ($_SESSION['quinzena'] == "Quinzena 1") {
        echo "<img src='../../Assets/img/dia 15.png' alt='a calendar with the number 15' width='72' height='70'> ";
      } else {
        echo "<img src='../../Assets/img/dia 30.png' alt='a calendar with the number 30' width='72' height='70'> ";
      }
      ?>
      <h2 id="Entrada_title">Entrada</h2>
      <a href="#Saida_title"> Navegar até os registros de Saída</a>
      <table class="table-saida">
        <thead>
          <tr>
            <th>Nª</th>
            <th>Descrição</th>
            <th>valor</th>
            <th>Data</th>
            <th>Alteração</th>
            <th>Exclusão</th>
          </tr>
        </thead>
        <tbody>
          <?php
          $contador = 1;
          foreach ($Entrada_fetch as $linha) {
          ?>
            <tr>
              <td> <?php echo $contador; ?> </td>
              <td> <?php echo $linha['descricao']; ?> </td>
              <td> <?php echo "R$" . $linha['valor']; ?> </td>
              <td> <?php echo $linha['dataDespensa']; ?> </td>
              <td>
                <form action="alterar.php" method="post">
                  <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                  <input type="hidden" value="DESPENSAS" name="pagina_inicial">
                  <button type="submit"><img src="../../Assets//Icons//pencil.png" class="icon_exclusao"></button>
                </form>
              </td>
              <td>
                <form action="excluir.php" method="post">
                  <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                  <input type="hidden" value="DESPENSAS" name="pagina_inicial">
                  <button type="submit"><img src="../../Assets//Icons//x-mark-xxl.png" class="icon_exclusao"></button>
                </form>
              </td>
            </tr>
          <?php
            $contador++;
          }

          /*┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
          * │                                Adicionado um novo registro                                                    │
          * └───────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
          */

          if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO ENTRADA") {
          ?>
            <form method="post">
              <input type="hidden" name="adicionando_registro" value='SALVANDO REGISTRO ENTRADA'>
              <input type="hidden" name="statusDespensa" value='3'>
              <tr>
                <th>Nª</th>
                <th><input type="text" name="descricao" placeholder="Nome do produto"></th>
                <th><input type="number" min="1" step="any" name="valor" placeholder="2.00"></th>
                <th> <input type="date" name="data" value='<?php echo date("Y-m-d"); ?>'></th>
              </tr>
            <?php
          }
            ?>
        </tbody>
      </table>

      <?php

      /*┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
      * │                                Botões de manipulação                                                          │
      * └───────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
      */

      if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO ENTRADA") {
      ?>
        <div class="botoes-registro">
          <button type="submit" class="botao-registrar">Registrar</button>
          </form>
          <form action="despensas.php" method="post">
            <input type="hidden" value="" name="adicionando_registro">
            <button type="submit" class="botao-cancelar">Cancelar</button>
          </form>
        </div>

      <?php
      }

      if ($adicionando_registro == null) {
      ?>
        <form action="despensas.php" method="post">
          <input type="hidden" value="REGISTRANDO ENTRADA" name="adicionando_registro">
          <button type="submit" class="botao-novoRegistro">Adicionar um novo registro</button>
        </form>
      <?php
      }
      ?>
    </session>
  </main>
</body>

</html>