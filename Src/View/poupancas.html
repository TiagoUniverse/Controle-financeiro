<!doctype html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../Assets//Css//styles.css" rel="stylesheet">
  <link href="../../Assets//Css//dropdown.css" rel="stylesheet">
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" 
  integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous"> -->
  <title> Poupança de
    <?php echo $_SESSION['ano']; ?>
  </title>
</head>

<body>
  <?php require_once "Recursos/Navegacao.php"; ?>

  <form action="home.php" method="post">
    <input type="hidden" name="statusMes" value="<?php echo $_SESSION['statusMes']; ?>">
    <button class="voltar-menu" style="border:none;">Voltar</button>
  </form>

  <main class="main-despensas">
    <h2>
      <?php echo "Poupança de " . $_SESSION['ano']  . ": " . $_SESSION['tipo_registro']; ?>
    </h2>

    <!-- Dinheiro total -->
    <table class="table-dinheiroTotal">
      <thead>
        <tr>
          <?php
          if ($_SESSION['tipo_registro'] == "Registros pessoais") {
            echo "<th scope='col'> Gastos pessoais total </th>";
            echo "<th scope='col'> Receita pessoal total </th>";
          } else {
            echo "<th scope='col'> Gastos total da casa </th>";
            echo "<th scope='col'> Receita total da casa </th>";
          }
          ?>
          <th>Total que possuo agora (valor líquido) </th>
          <th>Soma dos valores líquidos da casa com o pessoal</th>
          <th>Valor total da poupança estimado</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>
            <?php echo "R$" . $dinheiroSaida; ?>
          </th>
          <th>
            <?php echo "R$" . $dinheiroEntrada; ?>
          </th>
          <th id="dinheiro-total-Resultado">
            <?php echo "R$" . ($dinheiroEntrada - $dinheiroSaida) ?>
          </th>
          <th>
            <?php echo "R$" . $dinheiroTotal; ?>
          </th>
          <th>
            <form action="poupancas.php" method="post">
              <input type="hidden" value="SALVANDO VALOR ESTIMADO" name="adicionando_registro">
              <input type="float" class="form-control" name="valor_estimado" value=" <?php echo $valorEstimado; ?> "
                required>
              <button type="submit" class="btn btn-primary"> Salvar</button>
            </form>
          </th>
        </tr>
      </tbody>
    </table>




    <h3>Abaixo registre todas as entradas e saídas da sua poupança</h3>
    <img src="../../Assets/Icons//bank.png" alt="imagem de um porco de poupança" width="72" height="70">

    <session>
      <h1>Saída</h1>
      <div class="col-lg-6 mx-auto">
        <p class="lead mb-4">Por favor, digite um ano e mês válido na tela inicial.</p>
        <a href="#Entrada_title"> Navegar até os registros de Entrada</a>
        <table class="table-saida">
          <thead>
            <tr>
              <th>Nª</th>
              <th>Descrição</th>
              <th>valor</th>
              <th>Data</th>
              <th>Alteração</th>
              <th>Exclusão</th>
            </tr>
          </thead>
          <tbody>
            <?php

              $contador = 1;
              foreach ($Saida_fetch as $linha) {
              ?>
            <tr>
              <!-- <th scope="row">1</th> -->
              <td>
                <?php echo $contador; ?>
              </td>
              <td>
                <?php echo $linha['descricao']; ?>
              </td>
              <td>
                <?php echo "R$" . $linha['valor']; ?>
              </td>
              <td>
                <?php echo $linha['dataPoupanca']; ?>
              </td>
              <td>

                <form action="alterar.php" method="post">
                  <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                  <input type="hidden" value="POUPANCA" name="pagina_inicial">
                  <button type="submit"> <img src="../../Assets//Icons//pencil.png" class="icon_exclusao"></button>
                </form>

              </td>
              <td>

                <form action="excluir.php" method="post">
                  <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                  <input type="hidden" value="POUPANCA" name="pagina_inicial">
                  <button type="submit"> <img src="../../Assets//Icons//x-mark-xxl.png" class="icon_exclusao"></button>
                </form>

              </td>
            </tr>
            <?php
                $contador++;
              }

              if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO SAIDA") {
              ?>
            <form method="post">
              <input type="hidden" name="adicionando_registro" value='SALVANDO REGISTRO SAIDA'>
              <input type="hidden" name="statusDespensa" value='3'>
              <tr>
                <th>Nª</th>
                <th>
                  <input type="text" name="descricao">
                </th>
                <th>
                  <input type="number" min="1" step="any" name="valor">
                </th>
                <th>
                  <input type="date" name="data" value='<?php echo date("Y-m-d"); ?>'>
                </th>

              </tr>
              <?php
              }

                ?>
          </tbody>

        </table>


        <?php
        if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO SAIDA") {
        ?>

        <div class="botoes-registro">
          <button type="submit" class="botao-registrar">Registrar</button>
          </form>
          <form action="poupancas.php" method="post">
            <input type="hidden" value="" name="adicionando_registro">
            <button type="submit" class="botao-cancelar">Cancelar</button>
          </form>
        </div>

        <?php
        }

        if ($adicionando_registro == null) {
        ?>
        <form action="poupancas.php" method="post">
          <input type="hidden" value="REGISTRANDO SAIDA" name="adicionando_registro">
          <button type="submit" class="botao-novoRegistro">Adicionar um novo registro</button>
        </form>
        <?php
        }
        ?>
    </session>

    <session>
      <img class="d-block mx-auto mb-4" src="../../Assets/Icons//bank.png" alt="imagem de um porco de poupança"
        width="72" height="70">

      <h1 class="display-5 fw-bold" id="Entrada_title">Entrada</h1>
      <p class="lead mb-4">Por favor, digite um ano e mês válido na tela inicial.</p>
      <a href="#Saida_title"> Navegar até os registros de Saída</a>
      <table class="table-saida">
        <thead>
          <tr>
            <th>Nª</th>
            <th>Descrição</th>
            <th>valor</th>
            <th>Data</th>
            <th>Alteração</th>
            <th>Exclusão</th>
          </tr>
        </thead>
        <tbody>
          <?php

              $contador = 1;
              foreach ($Entrada_fetch as $linha) {
              ?>
          <tr>
            <!-- <th scope="row">1</th> -->
            <td>
              <?php echo $contador; ?>
            </td>
            <td>
              <?php echo $linha['descricao']; ?>
            </td>
            <td>
              <?php echo "R$" . $linha['valor']; ?>
            </td>
            <td>
              <?php echo $linha['dataPoupanca']; ?>
            </td>
            <td>

              <form action="alterar.php" method="post">
                <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                <input type="hidden" value="POUPANCA" name="pagina_inicial">
                <button type="submit"> <img src="../../Assets//Icons//pencil.png" class="icon_exclusao"></button>
              </form>

            </td>
            <td>

              <form action="excluir.php" method="post">
                <input type="hidden" value=" <?php echo $linha['id']; ?>" name="id">
                <input type="hidden" value="POUPANCA" name="pagina_inicial">
                <button type="submit"> <img src="../../Assets//Icons//x-mark-xxl.png" class="icon_exclusao"></button>
              </form>

            </td>
          </tr>
          <?php
                $contador++;
              }

              if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO ENTRADA") {
              ?>
          <form method="post">
            <input type="hidden" name="adicionando_registro" value='SALVANDO REGISTRO ENTRADA'>
            <input type="hidden" name="statusDespensa" value='3'>
            <tr>
              <th>Nª</th>
              <th>
                <input type="text" name="descricao">
              </th>
              <th>
                <input type="number" min="1" step="any" name="valor">
              </th>
              <th>
                <input type="date" name="data" value='<?php echo date("Y-m-d"); ?>'>
              </th>

            </tr>
            <?php
              }

                ?>
        </tbody>

      </table>


      <?php
        if ($adicionando_registro != null && $adicionando_registro == "REGISTRANDO ENTRADA") {
        ?>

      <div class="botoes-registro">
        <button type="submit" class="botao-registrar">Registrar</button>
        </form>
        <form action="poupancas.php" method="post">
          <input type="hidden" value="" name="adicionando_registro">
          <button type="submit" class="botao-cancelar">Cancelar</button>
        </form>
      </div>

      <?php
        }

        if ($adicionando_registro == null) {
        ?>
      <form action="poupancas.php" method="post">
        <input type="hidden" value="REGISTRANDO ENTRADA" name="adicionando_registro">
        <button type="submit" class="botao-novoRegistro">Adicionar um novo registro</button>
      </form>
      <?php
        }
        ?>


    </session>
  </main>

  <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script> -->
</body>

</html>